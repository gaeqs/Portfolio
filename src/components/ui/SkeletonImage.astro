---
interface Props {
  src: string;
  alt: string;
  class?: string;
  loading?: "eager" | "lazy";
}

const { src, alt, class: className = "", loading = "lazy" } = Astro.props;
---

<div class={`relative overflow-hidden bg-zinc-900 ${className}`}>

  <div class="absolute inset-0 z-0 skeleton-loader"></div>

  <img
    src={src}
    alt={alt}
    loading={loading}
    class={`relative z-10 w-full h-full object-cover opacity-0 transition-opacity duration-700 ease-out`}
    onload="this.classList.remove('opacity-0'); this.previousElementSibling?.remove()"
  />

  <slot />
</div>

<style>
  @keyframes skeleton-loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
  }

  .skeleton-loader {
      background: linear-gradient(90deg, rgba(24,24,27,1) 0%, rgba(39,39,42,1) 50%, rgba(24,24,27,1) 100%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s infinite linear;
  }
</style>